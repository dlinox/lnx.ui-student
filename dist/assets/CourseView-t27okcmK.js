import{a6 as ae,d as K,b as V,A as ue,c as v,bh as oe,w as e,a as l,j as ne,V as B,r as se,f as T,Y as J,R as L,i as t,bf as P,bg as G,bi as re,e as b,U as de,bj as w,t as o,F as j,g as H,Z as O,h as U,o as d,b8 as ie,ap as ve,b6 as ee,b0 as be,S as k,b5 as x,b4 as C,u as Z,T as ge,bk as Ve,b2 as _e,O as Ie}from"./index-BCiygQBv.js";import{_ as Se}from"./index-DdMHZq7_.js";import{r as F}from"./rules.utils-DeZMMdPe.js";import{V as z,_ as me,a as ke,b as xe}from"./VAlert-CWdeLtXC.js";import{V as pe}from"./VForm-BR8Hmo_o.js";import{V as q,a as g}from"./VRow-BY8_SUxz.js";import{V as fe,a as ce}from"./VItem-CG-UGpSY.js";import{V as Q}from"./VContainer-BGw3r08E.js";import{u as Ce}from"./heading.store-DQe6cmSj.js";import{u as Ae}from"./period.stores-S6Obukk0.js";const ye="courses",Ne=async(M,I)=>{try{return(await ae().get(`${ye}/curriculum/${I}/module/${M}`)).data.data}catch{return[]}},we=async M=>{try{return(await ae().get(`${ye}/module/${M}/select`)).data.data}catch{return[]}},le=()=>({moduleId:null,courseId:null,groupId:null,curriculumId:null,paymentAmount:0,paymentMethod:null,paymentDate:null,paymentSequence:null}),te={moduleId:[F],courseId:[F],curriculumId:[F],paymentAmount:[F],paymentMethod:[F],paymentDate:[F],paymentSequence:[F]},Me={class:"d-flex justify-end"},Le=K({__name:"Enrollment",props:{studentId:{},module:{}},emits:["success"],setup(M,{emit:I}){const E=I,A=M,c=V(null),_=V(!1),S=V(!1),y=V(te),$=V([]),n=V([]),m=V(Object.assign({},le())),i=async()=>{n.value=await me({courseId:m.value.courseId}),m.value.groupId=null},a=async()=>{var f;const{valid:u}=await((f=c.value)==null?void 0:f.validate());if(!u)return;S.value=!0,await ke(m.value)&&(E("success"),_.value=!1),S.value=!1},p=async()=>{m.value=Object.assign({},le()),y.value=te,m.value.moduleId=A.module.id,m.value.paymentAmount=Number(A.module.prices),m.value.curriculumId=A.module.curriculumId,$.value=await we(A.module.id)};return ue(()=>_.value,u=>{u&&p()}),(u,r)=>{const f=se("LnxIcon");return d(),v(oe,{"max-width":"600",modelValue:_.value,"onUpdate:modelValue":r[6]||(r[6]=N=>_.value=N),activator:"parent",scrollable:""},{default:e(()=>[l(pe,{ref_key:"formRef",ref:c,onSubmit:ne(a,["prevent"])},{default:e(()=>{var N;return[l(B,{title:(N=u.module)==null?void 0:N.name,subtitle:"Registrar pago"},{default:e(()=>[l(z,{color:"gray",class:"rounded-0 text-caption",variant:"tonal",text:"Recuerda que los pagos se actualizan al día siguiente. Si realizas tu pago hoy, será registrado mañana. Para evitar inconvenientes, te recomendamos pagar con anticipación.",elevation:"0"},{prepend:e(()=>[l(f,{iconName:"info-circle"})]),_:1}),l(T,{class:"border-t border-b"},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"12"},{default:e(()=>[l(J,{modelValue:m.value.courseId,"onUpdate:modelValue":[r[0]||(r[0]=s=>m.value.courseId=s),i],items:$.value,label:"Cursos",placeholder:"Selecciona un curso",rules:y.value.courseId},null,8,["modelValue","items","rules"])]),_:1}),l(g,{cols:"12"},{default:e(()=>[l(fe,{mandatory:"",class:"border-t"},{default:e(()=>[l(Q,{style:{height:"auto","max-height":"180px","overflow-y":"auto"}},{default:e(()=>[n.value.length===0?(d(),v(z,{key:0,type:"warning",variant:"tonal"},{default:e(()=>r[7]||(r[7]=[t(" No hay grupos habilitados para este curso. ")])),_:1})):L("",!0),l(q,{dense:""},{default:e(()=>[(d(!0),P(j,null,G(n.value,(s,D)=>(d(),v(g,{key:D,cols:"12"},{default:e(()=>[l(ce,null,{default:e(({isSelected:R,toggle:W})=>[l(B,{color:R?"primary":"",variant:R?"tonal":"plain",onClick:Y=>{W&&W(),m.value.groupId=s.id,m.value.paymentAmount=Number(A.module.prices)+Number(s.price)},class:"border"},{default:e(()=>[l(re,null,{default:e(()=>[l(T,null,{default:e(()=>[b("div",Me,[de((d(),v(w,{variant:"flat",color:s.enrolledStudents/s.minStudents*100>=100?"green-accent-3":s.enrolledStudents/s.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[t(o(`${s.enrolledStudents} / ${s.minStudents}`),1)]),_:2},1032,["color"])),[[ie,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),l(w,{density:"compact",color:"info",rounded:"sm"},{default:e(()=>[t(o(s.modality),1)]),_:2},1024),t(" "+o(s.group)+" - ",1),b("strong",null," S/. "+o(s.price),1),r[9]||(r[9]=b("br",null,null,-1)),b("small",null,[s.schedules?(d(),v(w,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>{var Y,X,h;return[b("strong",null,o((Y=s.schedules)==null?void 0:Y.days)+" - "+o((X=s.schedules)==null?void 0:X.startHour)+" a "+o((h=s.schedules)==null?void 0:h.endHour),1)]}),_:2},1024)):(d(),v(w,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>r[8]||(r[8]=[t(" No hay horarios disponibles ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(J,{modelValue:m.value.paymentMethod,"onUpdate:modelValue":r[1]||(r[1]=s=>m.value.paymentMethod=s),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago realizado en",rules:y.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:m.value.paymentSequence,"onUpdate:modelValue":r[2]||(r[2]=s=>m.value.paymentSequence=s),label:"Numero de operacion",type:"number",rules:y.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:m.value.paymentAmount,"onUpdate:modelValue":r[3]||(r[3]=s=>m.value.paymentAmount=s),readonly:"",label:"Monto",type:"number",rules:y.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:m.value.paymentDate,"onUpdate:modelValue":r[4]||(r[4]=s=>m.value.paymentDate=s),label:"Fecha",type:"date",rules:y.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[l(U,{type:"button",variant:"tonal",color:"secondary",onClick:r[5]||(r[5]=s=>_.value=!1)},{default:e(()=>r[10]||(r[10]=[t("Cancelar")])),_:1}),l(U,{text:"Matricular",color:"primary",type:"submit",loading:S.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"])}}}),Ee={class:"d-flex justify-end"},$e=K({__name:"EnrollmentGroup",props:{course:{}},emits:["success"],setup(M,{emit:I}){const E=I,A=M,c=V(!1),_=V(!1),S=V([]),y=V({paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null}),$=V([]),n=async()=>{_.value=!0,await xe(y.value)&&(E("success"),c.value=!1),_.value=!1},m=async()=>{y.value={paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null},$.value=await me({courseId:A.course.id})};return ue(()=>c.value,i=>{i&&m()}),(i,a)=>(d(),v(oe,{"max-width":"600",modelValue:c.value,"onUpdate:modelValue":a[5]||(a[5]=p=>c.value=p),activator:"parent"},{default:e(()=>[l(pe,{ref:"formRef",onSubmit:ne(n,["prevent"])},{default:e(()=>{var p;return[l(B,{title:(p=i.course)==null?void 0:p.name,subtitle:"Registrar pago"},{default:e(()=>[l(fe,{mandatory:"",class:"border-t"},{default:e(()=>[l(Q,{style:{height:"auto","max-height":"280px","overflow-y":"auto"}},{default:e(()=>[$.value.length===0?(d(),v(z,{key:0,type:"warning",variant:"tonal"},{default:e(()=>a[6]||(a[6]=[t(" No hay grupos habilitados para este curso. ")])),_:1})):L("",!0),l(q,{dense:""},{default:e(()=>[(d(!0),P(j,null,G($.value,(u,r)=>(d(),v(g,{key:r,cols:"12"},{default:e(()=>[l(ce,null,{default:e(({isSelected:f,toggle:N})=>[l(B,{color:f?"primary":"",variant:f?"tonal":"plain",onClick:s=>{N&&N(),y.value.groupId=u.id,y.value.paymentAmount=u.price},class:"border"},{default:e(()=>[l(re,null,{default:e(()=>[l(T,null,{default:e(()=>[b("div",Ee,[de((d(),v(w,{class:"rounded-0",variant:"flat",color:u.enrolledStudents/u.minStudents*100>=100?"green-accent-3":u.enrolledStudents/u.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[t(o(`${u.enrolledStudents} / ${u.minStudents}`),1)]),_:2},1032,["color"])),[[ie,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),t(" "+o(u.group)+" - ",1),b("strong",null," S/. "+o(u.price),1),a[11]||(a[11]=b("br",null,null,-1)),l(w,{class:"rounded-0",density:"compact",color:"info",rounded:"sm"},{default:e(()=>[t(o(u.modality),1)]),_:2},1024),a[12]||(a[12]=b("br",null,null,-1)),b("small",null,[a[7]||(a[7]=t("Docente: ")),b("strong",null,o(u.teacher),1)]),a[13]||(a[13]=b("br",null,null,-1)),b("small",null,[a[8]||(a[8]=t(" Laboratorio: ")),b("strong",null,o(u.laboratory),1)]),a[14]||(a[14]=b("br",null,null,-1)),b("small",null,[a[10]||(a[10]=t(" Horarios: ")),u.schedules?(d(),v(w,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>{var s,D,R;return[t(o((s=u.schedules)==null?void 0:s.days)+" "+o((D=u.schedules)==null?void 0:D.startHour)+" - "+o((R=u.schedules)==null?void 0:R.endHour),1)]}),_:2},1024)):(d(),v(w,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>a[9]||(a[9]=[t(" No hay horarios ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),l(T,{class:"border-t border-b"},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"6"},{default:e(()=>[l(J,{modelValue:y.value.paymentMethod,"onUpdate:modelValue":a[0]||(a[0]=u=>y.value.paymentMethod=u),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago en",rules:S.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:y.value.paymentSequence,"onUpdate:modelValue":a[1]||(a[1]=u=>y.value.paymentSequence=u),label:"Numero de operacion",type:"number",rules:S.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:y.value.paymentAmount,"onUpdate:modelValue":a[2]||(a[2]=u=>y.value.paymentAmount=u),readonly:"",label:"Monto",type:"number",rules:S.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:y.value.paymentDate,"onUpdate:modelValue":a[3]||(a[3]=u=>y.value.paymentDate=u),label:"Fecha",type:"date",rules:S.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[l(U,{type:"button",variant:"tonal",color:"secondary",onClick:a[4]||(a[4]=u=>c.value=!1)},{default:e(()=>a[15]||(a[15]=[t(" Cancelar ")])),_:1}),l(U,{text:"Inscribirme",color:"primary",type:"submit",variant:"flat",value:"submit",loading:_.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"]))}}),De={key:1},Fe=["href"],Pe={key:1},Ye=K({__name:"CourseView",setup(M){const I=Ae(),E=Ce(),A=Ie(),c=V(null),_=V([]),S=V(""),y=async()=>{S.value=A.params.id,c.value=await Se(S.value,2),_.value=await Ne(c.value.id,2),E.setHeading(c.value.name,"Cursos disponibles del modulo")};return ve(()=>{y()}),($,n)=>{const m=se("LnxIcon");return d(),v(Q,null,{default:e(()=>[l(q,{class:""},{default:e(()=>[l(g,{cols:"12",md:"5",lg:"4"},{default:e(()=>[l(B,{elevation:"1"},{default:e(()=>{var i,a;return[l(ee),l(be,{"two-line":""},{default:e(()=>[l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[0]||(n[0]=[t(" Detalles ")])),_:1}),l(C,{"three-line":"",class:"text-subtitle-2"},{default:e(()=>{var p,u,r;return[t(o((p=c.value)==null?void 0:p.coursesCount)+" Cursos , "+o((u=c.value)==null?void 0:u.hoursPractice)+" Hr. Practicas, "+o((r=c.value)==null?void 0:r.hoursTheory)+" Hr. Teoricas ",1)]}),_:1})]),_:1}),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[1]||(n[1]=[t(" Creditos ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var p;return[t(o((p=c.value)==null?void 0:p.credits),1)]}),_:1})]),_:1}),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[2]||(n[2]=[t(" Area(s) ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var p;return[t(o((p=c.value)==null?void 0:p.areas),1)]}),_:1})]),_:1}),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[3]||(n[3]=[t(" Precio de matricula ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var p;return[t(" S/. "+o((p=c.value)==null?void 0:p.prices),1)]}),_:1})]),_:1})]),_:1}),(i=c.value)!=null&&i.isEnrolled?(d(),v(U,{key:0,variant:"tonal",block:"",color:"success"},{prepend:e(()=>[l(m,{iconName:"verify"})]),default:e(()=>[n[4]||(n[4]=t(" Matriculado "))]),_:1})):L("",!0),((a=c.value)==null?void 0:a.isEnrolled)==!1?(d(),v(O,{key:1},{default:e(()=>{var p;return[((p=c.value)==null?void 0:p.prices)!==null?(d(),v(U,{key:0,block:"",class:"mt-2"},{default:e(()=>[n[5]||(n[5]=t(" Matricular ")),l(Le,{module:c.value,onSuccess:y},null,8,["module"])]),_:1})):(d(),v(z,{key:1,variant:"tonal",color:"error"},{default:e(()=>n[6]||(n[6]=[t(" No se puede matricular, no hay precios establecidos. ")])),_:1}))]}),_:1})):L("",!0)]}),_:1})]),_:1}),l(g,{cols:"12",md:"7",lg:"8"},{default:e(()=>[l(q,null,{default:e(()=>[(d(!0),P(j,null,G(_.value,(i,a)=>(d(),v(g,{cols:"12",key:a},{default:e(()=>[l(B,{elevation:"1",subtitle:i==null?void 0:i.area},{default:e(()=>{var p,u,r;return[l(ee,{class:"pt-0"},{default:e(()=>[b("small",null,[b("strong",null,o(i.code)+" - ",1),t(" "+o(i.name),1)])]),_:2},1024),i.description?(d(),v(T,{key:0,class:"text-caption"},{default:e(()=>[t(o(i.description),1)]),_:2},1024)):L("",!0),l(T,null,{default:e(()=>[b("small",null,o(i.credits.toFixed(2))+" Creditos | "+o(i.hoursPractice)+" Hr. Practicas | "+o(i.hoursTheory)+" Hr. Teoricas ",1)]),_:2},1024),i.hasEnrollment?(d(!0),P(j,{key:1},G(i.enrollment,(f,N)=>(d(),v(T,{class:"border-t",key:N},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"12",md:"6"},{default:e(()=>[l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[7]||(n[7]=[t("Periodo")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>{var s,D;return[f.periodId==((D=(s=Z(I))==null?void 0:s.enrolled)==null?void 0:D.periodId)?(d(),v(w,{key:0,class:"text-caption",density:"compact",color:"blue"},{default:e(()=>[t(o(f.period),1)]),_:2},1024)):(d(),P("span",De,o(f.period),1))]}),_:2},1024)]),_:2},1024),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[8]||(n[8]=[t("Gupo")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(o(f.group),1)]),_:2},1024)]),_:2},1024),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[9]||(n[9]=[t("Docente")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(o(f.teacher||"-"),1)]),_:2},1024)]),_:2},1024),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[10]||(n[10]=[t("Nota")])),_:1}),l(C,{class:ge(["text-caption",f.grade>=10?"text-success":"text-error"])},{default:e(()=>[t(o(f.grade||"-"),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),l(g,{cols:"12",md:"6"},{default:e(()=>[l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[11]||(n[11]=[t("Modalidad")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(o(f.modality),1)]),_:2},1024)]),_:2},1024),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[12]||(n[12]=[t("Laboratorio")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[f.modality=="VIRTUAL"?(d(),P("a",{key:0,href:f.virtualLink,target:"_blank",class:"text-primary"},[l(Ve,null,{default:e(()=>[l(m,{iconName:"link-1"})]),_:1}),t(" "+o(f.laboratory),1)],8,Fe)):(d(),P("span",Pe,o(f.laboratory),1))]),_:2},1024)]),_:2},1024),l(k,null,{default:e(()=>[l(x,null,{default:e(()=>n[13]||(n[13]=[t("Horario")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(o(f.schedule),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):L("",!0),!i.isApproved&&((p=Z(I))!=null&&p.enrolled)&&i.lastEnrollment!=((r=(u=Z(I))==null?void 0:u.enrolled)==null?void 0:r.periodId)?(d(),v(O,{key:2,class:"bg-grey-lighten-4"},{default:e(()=>{var f;return[l(_e),(f=c.value)!=null&&f.isEnrolled?(d(),v(U,{key:0,variant:"outlined"},{default:e(()=>[l($e,{course:i,onSuccess:y},null,8,["course"]),n[14]||(n[14]=t(" Inscríbete "))]),_:2},1024)):L("",!0)]}),_:2},1024)):L("",!0)]}),_:2},1032,["subtitle"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Ye as default};
