import{u as D,_ as A,a as P}from"./index-DT43BGsp.js";import{d as R,l as i,aa as S,be as q,aM as F,a as t,w as o,g as V,h as c,r as g,V as d,b as m,e as k,aO as L,f as U,F as z,o as E}from"./index-CMWRQILe.js";import{a as M,V as f}from"./VRow-DB3tsM5B.js";import{V as O}from"./VContainer-DpzZP2Dk.js";import"./index-CklmRQ5G.js";import"./index-BoZKkaqZ.js";const Q={class:"text-h3 text-center text-blue"},W=R({__name:"AttendanceRecordView",setup($){const v=D(),y=i(null),l=i(!1),p=i(""),n=i({documentNumber:"",token:"",periodId:null}),_=()=>{const a=new Date;p.value=a.toLocaleTimeString()},N=(a,e)=>{for(const r of a){const[s,...u]=r.cornerPoints;e.strokeStyle="red",e.beginPath(),e.moveTo(s.x,s.y);for(const{x:B,y:T}of u)e.lineTo(B,T);e.lineTo(s.x,s.y),e.closePath(),e.stroke()}},w=async()=>{var a;n.value.periodId=(a=v.current)==null?void 0:a.id,await P(n.value)},C=async()=>{var e;n.value.periodId=(e=v.current)==null?void 0:e.id,await A(n.value)&&(n.value.documentNumber="")},I=async([a])=>{y.value=a;const e=a.rawValue;n.value.token=e,n.value.documentNumber="",l.value=!0,await w(),l.value=!1},x=async()=>{};let b;return S(()=>{_(),b=setInterval(_,1e3),x()}),q(()=>{clearInterval(b)}),(a,e)=>{const r=g("LnxIcon"),s=g("qrcode-stream");return E(),F(z,null,[t(d,{title:"Ingreso",subtitle:"Registra la asistencia de los estudiantes",class:"rounded-0"},{append:o(()=>[t(V,{variant:"text",onClick:e[0]||(e[0]=u=>a.$router.go(-1))},{prepend:o(()=>[t(r,{iconName:"arrow-left-3",size:"large"})]),default:o(()=>[e[2]||(e[2]=c(" Atrás "))]),_:1})]),_:1}),t(O,null,{default:o(()=>[t(M,{justify:"center"},{default:o(()=>[t(f,{cols:"12"},{default:o(()=>[t(d,{elevation:"0",variant:"tonal"},{default:o(()=>[t(m,null,{default:o(()=>[k("div",Q,[k("strong",null,[t(r,{iconName:"clock-1",size:"x-large"}),c(" "+L(p.value),1)])])]),_:1})]),_:1})]),_:1}),t(f,{cols:"12",md:"8"},{default:o(()=>[t(d,{loading:l.value,elevation:"0",title:"Escanea el código QR",subtitle:"Use la cámara de su dispositivo para escanear el código QR"},{default:o(()=>[t(s,{onDetect:I,track:N})]),_:1},8,["loading"])]),_:1}),t(f,{cols:"12",md:"4"},{default:o(()=>[t(d,{elevation:"0",title:"Documento",subtitle:"Ingrese el número de documento"},{default:o(()=>[t(m,null,{default:o(()=>[t(U,{modelValue:n.value.documentNumber,"onUpdate:modelValue":e[1]||(e[1]=u=>n.value.documentNumber=u),label:"Número de documento",class:"me-2",density:"comfortable",type:"text"},null,8,["modelValue"])]),_:1}),t(m,null,{default:o(()=>[t(V,{onClick:C,disabled:l.value,variant:"flat",block:""},{default:o(()=>e[3]||(e[3]=[c(" Registrar ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{W as default};
