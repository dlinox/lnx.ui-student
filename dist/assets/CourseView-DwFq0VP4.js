import{d as z,b,A as Q,c as p,bg as W,w as e,a as l,j as X,V as P,r as h,f as L,Y as ee,g as D,Z as $,h as M,i as u,o as m,R as A,be as R,F as j,bf as O,bh as ue,e as v,U as oe,bi as U,t as r,b7 as ne,ap as se,b5 as Z,b0 as re,S as V,bj as g,b4 as _,u as G,T as de,b2 as ie,O as me}from"./index-ByPSuvDA.js";import{_ as pe}from"./index-DYUFzAHe.js";import{a as fe}from"./index-BVOoVE67.js";import{r as E}from"./rules.utils-DeZMMdPe.js";import{_ as ve,V as le,a as ye,b as ce}from"./VAlert-9-j4H7f3.js";import{V as te}from"./VForm-CajteMrW.js";import{V as F,a as y}from"./VRow-BPD64Pkv.js";import{V as be,a as Ve}from"./VItem-KyO4rPqP.js";import{V as ae}from"./VContainer-B6LpCVn4.js";import{u as ge}from"./heading.store-BDr_EUZ_.js";import{u as _e}from"./period.stores-Zo9JuUFZ.js";const J=()=>({moduleId:null,curriculumId:null,paymentAmount:null,paymentMethod:null,paymentDate:null,paymentSequence:null}),K={moduleId:[E],curriculumId:[E],paymentAmount:[E],paymentMethod:[E],paymentDate:[E],paymentSequence:[E]},Se=z({__name:"Enrollment",props:{studentId:{},module:{}},emits:["success"],setup(B,{emit:I}){const T=I,C=B,i=b(!1),S=b(!1),c=b(K),s=b(Object.assign({},J())),N=async()=>{S.value=!0,await ve(s.value)&&(T("success"),i.value=!1),S.value=!1},n=async()=>{s.value=Object.assign({},J()),c.value=K,s.value.moduleId=C.module.id,s.value.paymentAmount=C.module.prices,s.value.curriculumId=C.module.curriculumId};return Q(()=>i.value,x=>{x&&n()}),(x,o)=>{const a=h("LnxIcon");return m(),p(W,{"max-width":"600",modelValue:i.value,"onUpdate:modelValue":o[5]||(o[5]=d=>i.value=d),activator:"parent"},{default:e(()=>[l(te,{ref:"formRef",onSubmit:X(N,["prevent"])},{default:e(()=>{var d;return[l(P,{title:(d=x.module)==null?void 0:d.name,subtitle:"Registrar pago"},{default:e(()=>[l(P,{color:"info",variant:"tonal",subtitle:"El pago debe ser realizado con un dia de anticipación.",elevation:"0",class:"rounded-0"},{prepend:e(()=>[l(a,{iconName:"info-circle"})]),_:1}),l(L,{class:"border-t border-b"},{default:e(()=>[l(F,null,{default:e(()=>[l(y,{cols:"6"},{default:e(()=>[l(ee,{modelValue:s.value.paymentMethod,"onUpdate:modelValue":o[0]||(o[0]=t=>s.value.paymentMethod=t),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago en",rules:c.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentSequence,"onUpdate:modelValue":o[1]||(o[1]=t=>s.value.paymentSequence=t),label:"Numero de operacion",type:"number",rules:c.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentAmount,"onUpdate:modelValue":o[2]||(o[2]=t=>s.value.paymentAmount=t),readonly:"",label:"Monto",type:"number",rules:c.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentDate,"onUpdate:modelValue":o[3]||(o[3]=t=>s.value.paymentDate=t),label:"Fecha",type:"date",rules:c.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l($,null,{default:e(()=>[l(M,{type:"button",variant:"tonal",color:"secondary",onClick:o[4]||(o[4]=t=>i.value=!1)},{default:e(()=>o[6]||(o[6]=[u("Cancelar")])),_:1}),l(M,{text:"Matricular",color:"primary",type:"submit",loading:S.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"])}}}),xe={class:"d-flex justify-end"},Ie=z({__name:"EnrollmentGroup",props:{course:{}},emits:["success"],setup(B,{emit:I}){const T=I,C=B,i=b(!1),S=b(!1),c=b([]),s=b({paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null}),N=b([]),n=async()=>{S.value=!0,await ce(s.value)&&(T("success"),i.value=!1),S.value=!1,console.log(s.value)},x=async()=>{s.value={paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null},N.value=await ye({courseId:C.course.id})};return Q(()=>i.value,o=>{o&&x()}),(o,a)=>(m(),p(W,{"max-width":"600",modelValue:i.value,"onUpdate:modelValue":a[5]||(a[5]=d=>i.value=d),activator:"parent"},{default:e(()=>[l(te,{ref:"formRef",onSubmit:X(n,["prevent"])},{default:e(()=>{var d;return[l(P,{title:(d=o.course)==null?void 0:d.name,subtitle:"Registrar pago"},{default:e(()=>[l(be,{mandatory:"",class:"border-t"},{default:e(()=>[l(ae,{style:{height:"auto","max-height":"280px","overflow-y":"auto"}},{default:e(()=>[N.value.length===0?(m(),p(le,{key:0,type:"warning",variant:"tonal"},{default:e(()=>a[6]||(a[6]=[u(" No hay grupos habilitados para este curso. ")])),_:1})):A("",!0),l(F,{dense:""},{default:e(()=>[(m(!0),R(j,null,O(N.value,(t,k)=>(m(),p(y,{key:k,cols:"12"},{default:e(()=>[l(Ve,null,{default:e(({isSelected:f,toggle:H})=>[l(P,{color:f?"primary":"",variant:f?"tonal":"plain",onClick:w=>{H&&H(),s.value.groupId=t.id,s.value.paymentAmount=t.price},class:"border"},{default:e(()=>[l(ue,null,{default:e(()=>[l(L,null,{default:e(()=>[v("div",xe,[oe((m(),p(U,{class:"rounded-0",variant:"flat",color:t.enrolledStudents/t.minStudents*100>=100?"green-accent-3":t.enrolledStudents/t.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[u(r(`${t.enrolledStudents} / ${t.minStudents}`),1)]),_:2},1032,["color"])),[[ne,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),u(" "+r(t.group)+" - ",1),v("strong",null," S/. "+r(t.price),1),a[11]||(a[11]=v("br",null,null,-1)),l(U,{class:"rounded-0",density:"compact",color:"info",rounded:"sm"},{default:e(()=>[u(r(t.modality),1)]),_:2},1024),a[12]||(a[12]=v("br",null,null,-1)),v("small",null,[a[7]||(a[7]=u("Docente: ")),v("strong",null,r(t.teacher),1)]),a[13]||(a[13]=v("br",null,null,-1)),v("small",null,[a[8]||(a[8]=u(" Laboratorio: ")),v("strong",null,r(t.laboratory),1)]),a[14]||(a[14]=v("br",null,null,-1)),v("small",null,[a[10]||(a[10]=u(" Horarios: ")),t.schedules?(m(),p(U,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>{var w,q,Y;return[u(r((w=t.schedules)==null?void 0:w.days)+" "+r((q=t.schedules)==null?void 0:q.startHour)+" - "+r((Y=t.schedules)==null?void 0:Y.endHour),1)]}),_:2},1024)):(m(),p(U,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>a[9]||(a[9]=[u(" No hay horarios ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),l(L,{class:"border-t border-b"},{default:e(()=>[l(F,null,{default:e(()=>[l(y,{cols:"6"},{default:e(()=>[l(ee,{modelValue:s.value.paymentMethod,"onUpdate:modelValue":a[0]||(a[0]=t=>s.value.paymentMethod=t),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago en",rules:c.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentSequence,"onUpdate:modelValue":a[1]||(a[1]=t=>s.value.paymentSequence=t),label:"Numero de operacion",type:"number",rules:c.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentAmount,"onUpdate:modelValue":a[2]||(a[2]=t=>s.value.paymentAmount=t),readonly:"",label:"Monto",type:"number",rules:c.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"6"},{default:e(()=>[l(D,{modelValue:s.value.paymentDate,"onUpdate:modelValue":a[3]||(a[3]=t=>s.value.paymentDate=t),label:"Fecha",type:"date",rules:c.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l($,null,{default:e(()=>[l(M,{type:"button",variant:"tonal",color:"secondary",onClick:a[4]||(a[4]=t=>i.value=!1)},{default:e(()=>a[15]||(a[15]=[u(" Cancelar ")])),_:1}),l(M,{text:"Inscribirme",color:"primary",type:"submit",variant:"flat",value:"submit",loading:S.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"]))}}),Ce={key:1},qe=z({__name:"CourseView",setup(B){const I=_e(),T=ge(),C=me(),i=b(null),S=b([]),c=b(""),s=async()=>{c.value=C.params.id,i.value=await pe(c.value,2),S.value=await fe(i.value.id,2),T.setHeading(i.value.name,"Cursos disponibles del modulo")};return se(()=>{s()}),(N,n)=>{const x=h("LnxIcon");return m(),p(ae,null,{default:e(()=>[l(F,{class:""},{default:e(()=>[l(y,{cols:"12",md:"5",lg:"4"},{default:e(()=>[l(P,{elevation:"1"},{default:e(()=>{var o,a;return[l(Z),l(re,{"two-line":""},{default:e(()=>[l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[0]||(n[0]=[u(" Detalles ")])),_:1}),l(_,{"three-line":"",class:"text-subtitle-2"},{default:e(()=>{var d,t,k;return[u(r((d=i.value)==null?void 0:d.coursesCount)+" Cursos , "+r((t=i.value)==null?void 0:t.hoursPractice)+" Hr. Practicas, "+r((k=i.value)==null?void 0:k.hoursTheory)+" Hr. Teoricas ",1)]}),_:1})]),_:1}),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[1]||(n[1]=[u(" Creditos ")])),_:1}),l(_,{class:"text-subtitle-2"},{default:e(()=>{var d;return[u(r((d=i.value)==null?void 0:d.credits),1)]}),_:1})]),_:1}),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[2]||(n[2]=[u(" Area(s) ")])),_:1}),l(_,{class:"text-subtitle-2"},{default:e(()=>{var d;return[u(r((d=i.value)==null?void 0:d.areas),1)]}),_:1})]),_:1}),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[3]||(n[3]=[u(" Precio de matricula ")])),_:1}),l(_,{class:"text-subtitle-2"},{default:e(()=>{var d;return[u(" S/. "+r((d=i.value)==null?void 0:d.prices),1)]}),_:1})]),_:1})]),_:1}),(o=i.value)!=null&&o.isEnrolled?(m(),p(M,{key:0,variant:"tonal",block:"",color:"success"},{prepend:e(()=>[l(x,{iconName:"verify"})]),default:e(()=>[n[4]||(n[4]=u(" Matriculado "))]),_:1})):A("",!0),((a=i.value)==null?void 0:a.isEnrolled)==!1?(m(),p($,{key:1},{default:e(()=>{var d;return[((d=i.value)==null?void 0:d.prices)!==null?(m(),p(M,{key:0,block:"",class:"mt-2"},{default:e(()=>[n[5]||(n[5]=u(" Matricular ")),l(Se,{module:i.value,onSuccess:s},null,8,["module"])]),_:1})):(m(),p(le,{key:1,variant:"tonal",color:"error"},{default:e(()=>n[6]||(n[6]=[u(" No se puede matricular, no hay precios establecidos. ")])),_:1}))]}),_:1})):A("",!0)]}),_:1})]),_:1}),l(y,{cols:"12",md:"7",lg:"8"},{default:e(()=>[l(F,null,{default:e(()=>[(m(!0),R(j,null,O(S.value,(o,a)=>(m(),p(y,{cols:"12",key:a},{default:e(()=>[l(P,{elevation:"1",subtitle:o==null?void 0:o.area},{default:e(()=>{var d,t,k;return[l(Z,{class:"pt-0"},{default:e(()=>[v("small",null,[v("strong",null,r(o.code)+" - ",1),u(" "+r(o.name),1)])]),_:2},1024),o.description?(m(),p(L,{key:0,class:"text-caption"},{default:e(()=>[u(r(o.description),1)]),_:2},1024)):A("",!0),l(L,null,{default:e(()=>[v("small",null,r(o.credits.toFixed(2))+" Creditos | "+r(o.hoursPractice)+" Hr. Practicas | "+r(o.hoursTheory)+" Hr. Teoricas ",1)]),_:2},1024),o.hasEnrollment?(m(!0),R(j,{key:1},O(o.enrollment,(f,H)=>(m(),p(L,{class:"border-t",key:H},{default:e(()=>[l(F,null,{default:e(()=>[l(y,{cols:"12",md:"6"},{default:e(()=>[l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[7]||(n[7]=[u("Periodo")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>{var w,q;return[f.periodId==((q=(w=G(I))==null?void 0:w.enrolled)==null?void 0:q.periodId)?(m(),p(U,{key:0,class:"text-caption",density:"compact",color:"blue"},{default:e(()=>[u(r(f.period),1)]),_:2},1024)):(m(),R("span",Ce,r(f.period),1))]}),_:2},1024)]),_:2},1024),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[8]||(n[8]=[u("Gupo")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>[u(r(f.group),1)]),_:2},1024)]),_:2},1024),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[9]||(n[9]=[u("Docente")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>[u(r(f.teacher||"-"),1)]),_:2},1024)]),_:2},1024),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[10]||(n[10]=[u("Nota")])),_:1}),l(_,{class:de(["text-caption",f.grade>=10?"text-success":"text-error"])},{default:e(()=>[u(r(f.grade||"-"),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),l(y,{cols:"12",md:"6"},{default:e(()=>[l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[11]||(n[11]=[u("Modalidad")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>[u(r(f.modality),1)]),_:2},1024)]),_:2},1024),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[12]||(n[12]=[u("Laboratorio")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>[u(r(f.laboratory),1)]),_:2},1024)]),_:2},1024),l(V,null,{default:e(()=>[l(g,null,{default:e(()=>n[13]||(n[13]=[u("Horario")])),_:1}),l(_,{class:"text-caption"},{default:e(()=>[u(r(f.schedule),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):A("",!0),!o.isApproved&&((d=G(I))!=null&&d.enrolled)&&o.lastEnrollment!=((k=(t=G(I))==null?void 0:t.enrolled)==null?void 0:k.periodId)?(m(),p($,{key:2,class:"bg-grey-lighten-4"},{default:e(()=>{var f;return[l(ie),(f=i.value)!=null&&f.isEnrolled?(m(),p(M,{key:0,variant:"outlined"},{default:e(()=>[l(Ie,{course:o,onSuccess:s},null,8,["course"]),n[14]||(n[14]=u(" Inscríbete "))]),_:2},1024)):A("",!0)]}),_:2},1024)):A("",!0)]}),_:2},1032,["subtitle"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}});export{qe as default};
