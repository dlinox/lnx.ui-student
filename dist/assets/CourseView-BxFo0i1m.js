import{a6 as ae,d as K,b as V,A as ue,c as y,bh as oe,w as e,a as l,j as ne,V as U,r as se,f as P,Y as J,R as E,i as t,bf as R,bg as G,bi as re,e as b,U as de,bj as N,t as n,F as j,g as H,Z as O,h as T,o as d,b8 as ie,ap as ve,b6 as ee,b0 as be,S as x,b5 as k,b4 as C,u as Z,T as ge,b2 as Ve,O as _e}from"./index-9zkkqfMJ.js";import{_ as Ie}from"./index-BTuba5zD.js";import{r as F}from"./rules.utils-DeZMMdPe.js";import{V as z,_ as me,a as Se,b as xe}from"./VAlert-BqCarhSx.js";import{V as pe}from"./VForm-DrGyDbZq.js";import{V as q,a as g}from"./VRow-CxKOvH3t.js";import{V as fe,a as ce}from"./VItem-2Dm_3ZTs.js";import{V as Q}from"./VContainer-DJCRk81C.js";import{u as ke}from"./heading.store-BrPX5S_N.js";import{u as Ce}from"./period.stores-6bqshUUT.js";const ye="courses",Ae=async(M,I)=>{try{return(await ae().get(`${ye}/curriculum/${I}/module/${M}`)).data.data}catch{return[]}},we=async M=>{try{return(await ae().get(`${ye}/module/${M}/select`)).data.data}catch{return[]}},le=()=>({moduleId:null,courseId:null,groupId:null,curriculumId:null,paymentAmount:0,paymentMethod:null,paymentDate:null,paymentSequence:null}),te={moduleId:[F],courseId:[F],curriculumId:[F],paymentAmount:[F],paymentMethod:[F],paymentDate:[F],paymentSequence:[F]},Ne={class:"d-flex justify-end"},Me=K({__name:"Enrollment",props:{studentId:{},module:{}},emits:["success"],setup(M,{emit:I}){const L=I,A=M,p=V(null),_=V(!1),S=V(!1),f=V(te),$=V([]),o=V([]),c=V(Object.assign({},le())),i=async()=>{o.value=await me({courseId:c.value.courseId}),c.value.groupId=null},a=async()=>{var v;const{valid:u}=await((v=p.value)==null?void 0:v.validate());if(!u)return;S.value=!0,await Se(c.value)&&(L("success"),_.value=!1),S.value=!1},m=async()=>{c.value=Object.assign({},le()),f.value=te,c.value.moduleId=A.module.id,c.value.paymentAmount=Number(A.module.prices),c.value.curriculumId=A.module.curriculumId,$.value=await we(A.module.id)};return ue(()=>_.value,u=>{u&&m()}),(u,r)=>{const v=se("LnxIcon");return d(),y(oe,{"max-width":"600",modelValue:_.value,"onUpdate:modelValue":r[6]||(r[6]=w=>_.value=w),activator:"parent",scrollable:""},{default:e(()=>[l(pe,{ref_key:"formRef",ref:p,onSubmit:ne(a,["prevent"])},{default:e(()=>{var w;return[l(U,{title:(w=u.module)==null?void 0:w.name,subtitle:"Registrar pago"},{default:e(()=>[l(z,{color:"gray",variant:"tonal",text:"Recuerda que los pagos se actualizan al día siguiente. Si realizas tu pago hoy, será registrado mañana. Para evitar inconvenientes, te recomendamos pagar con anticipación.",elevation:"0",class:"rounded-0"},{prepend:e(()=>[l(v,{iconName:"info-circle"})]),_:1}),l(P,{class:"border-t border-b"},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"12"},{default:e(()=>[l(J,{modelValue:c.value.courseId,"onUpdate:modelValue":[r[0]||(r[0]=s=>c.value.courseId=s),i],items:$.value,label:"Cursos",placeholder:"Selecciona un curso",rules:f.value.courseId},null,8,["modelValue","items","rules"])]),_:1}),l(g,{cols:"12"},{default:e(()=>[l(fe,{mandatory:"",class:"border-t"},{default:e(()=>[l(Q,{style:{height:"auto","max-height":"180px","overflow-y":"auto"}},{default:e(()=>[o.value.length===0?(d(),y(z,{key:0,type:"warning",variant:"tonal"},{default:e(()=>r[7]||(r[7]=[t(" No hay grupos habilitados para este curso. ")])),_:1})):E("",!0),l(q,{dense:""},{default:e(()=>[(d(!0),R(j,null,G(o.value,(s,D)=>(d(),y(g,{key:D,cols:"12"},{default:e(()=>[l(ce,null,{default:e(({isSelected:B,toggle:W})=>[l(U,{color:B?"primary":"",variant:B?"tonal":"plain",onClick:Y=>{W&&W(),c.value.groupId=s.id,c.value.paymentAmount=Number(A.module.prices)+Number(s.price)},class:"border"},{default:e(()=>[l(re,null,{default:e(()=>[l(P,null,{default:e(()=>[b("div",Ne,[de((d(),y(N,{variant:"flat",color:s.enrolledStudents/s.minStudents*100>=100?"green-accent-3":s.enrolledStudents/s.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[t(n(`${s.enrolledStudents} / ${s.minStudents}`),1)]),_:2},1032,["color"])),[[ie,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),l(N,{density:"compact",color:"info",rounded:"sm"},{default:e(()=>[t(n(s.modality),1)]),_:2},1024),t(" "+n(s.group)+" - ",1),b("strong",null," S/. "+n(s.price),1),r[9]||(r[9]=b("br",null,null,-1)),b("small",null,[s.schedules?(d(),y(N,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>{var Y,X,h;return[b("strong",null,n((Y=s.schedules)==null?void 0:Y.days)+" - "+n((X=s.schedules)==null?void 0:X.startHour)+" a "+n((h=s.schedules)==null?void 0:h.endHour),1)]}),_:2},1024)):(d(),y(N,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>r[8]||(r[8]=[t(" No hay horarios disponibles ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(J,{modelValue:c.value.paymentMethod,"onUpdate:modelValue":r[1]||(r[1]=s=>c.value.paymentMethod=s),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago realizado en",rules:f.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:c.value.paymentSequence,"onUpdate:modelValue":r[2]||(r[2]=s=>c.value.paymentSequence=s),label:"Numero de operacion",type:"number",rules:f.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:c.value.paymentAmount,"onUpdate:modelValue":r[3]||(r[3]=s=>c.value.paymentAmount=s),readonly:"",label:"Monto",type:"number",rules:f.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:c.value.paymentDate,"onUpdate:modelValue":r[4]||(r[4]=s=>c.value.paymentDate=s),label:"Fecha",type:"date",rules:f.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[l(T,{type:"button",variant:"tonal",color:"secondary",onClick:r[5]||(r[5]=s=>_.value=!1)},{default:e(()=>r[10]||(r[10]=[t("Cancelar")])),_:1}),l(T,{text:"Matricular",color:"primary",type:"submit",loading:S.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"])}}}),Ee={class:"d-flex justify-end"},Le=K({__name:"EnrollmentGroup",props:{course:{}},emits:["success"],setup(M,{emit:I}){const L=I,A=M,p=V(!1),_=V(!1),S=V([]),f=V({paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null}),$=V([]),o=async()=>{_.value=!0,await xe(f.value)&&(L("success"),p.value=!1),_.value=!1},c=async()=>{f.value={paymentMethod:null,paymentSequence:null,paymentAmount:null,paymentDate:null,groupId:null},$.value=await me({courseId:A.course.id})};return ue(()=>p.value,i=>{i&&c()}),(i,a)=>(d(),y(oe,{"max-width":"600",modelValue:p.value,"onUpdate:modelValue":a[5]||(a[5]=m=>p.value=m),activator:"parent"},{default:e(()=>[l(pe,{ref:"formRef",onSubmit:ne(o,["prevent"])},{default:e(()=>{var m;return[l(U,{title:(m=i.course)==null?void 0:m.name,subtitle:"Registrar pago"},{default:e(()=>[l(fe,{mandatory:"",class:"border-t"},{default:e(()=>[l(Q,{style:{height:"auto","max-height":"280px","overflow-y":"auto"}},{default:e(()=>[$.value.length===0?(d(),y(z,{key:0,type:"warning",variant:"tonal"},{default:e(()=>a[6]||(a[6]=[t(" No hay grupos habilitados para este curso. ")])),_:1})):E("",!0),l(q,{dense:""},{default:e(()=>[(d(!0),R(j,null,G($.value,(u,r)=>(d(),y(g,{key:r,cols:"12"},{default:e(()=>[l(ce,null,{default:e(({isSelected:v,toggle:w})=>[l(U,{color:v?"primary":"",variant:v?"tonal":"plain",onClick:s=>{w&&w(),f.value.groupId=u.id,f.value.paymentAmount=u.price},class:"border"},{default:e(()=>[l(re,null,{default:e(()=>[l(P,null,{default:e(()=>[b("div",Ee,[de((d(),y(N,{class:"rounded-0",variant:"flat",color:u.enrolledStudents/u.minStudents*100>=100?"green-accent-3":u.enrolledStudents/u.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[t(n(`${u.enrolledStudents} / ${u.minStudents}`),1)]),_:2},1032,["color"])),[[ie,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),t(" "+n(u.group)+" - ",1),b("strong",null," S/. "+n(u.price),1),a[11]||(a[11]=b("br",null,null,-1)),l(N,{class:"rounded-0",density:"compact",color:"info",rounded:"sm"},{default:e(()=>[t(n(u.modality),1)]),_:2},1024),a[12]||(a[12]=b("br",null,null,-1)),b("small",null,[a[7]||(a[7]=t("Docente: ")),b("strong",null,n(u.teacher),1)]),a[13]||(a[13]=b("br",null,null,-1)),b("small",null,[a[8]||(a[8]=t(" Laboratorio: ")),b("strong",null,n(u.laboratory),1)]),a[14]||(a[14]=b("br",null,null,-1)),b("small",null,[a[10]||(a[10]=t(" Horarios: ")),u.schedules?(d(),y(N,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>{var s,D,B;return[t(n((s=u.schedules)==null?void 0:s.days)+" "+n((D=u.schedules)==null?void 0:D.startHour)+" - "+n((B=u.schedules)==null?void 0:B.endHour),1)]}),_:2},1024)):(d(),y(N,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>a[9]||(a[9]=[t(" No hay horarios ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),l(P,{class:"border-t border-b"},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"6"},{default:e(()=>[l(J,{modelValue:f.value.paymentMethod,"onUpdate:modelValue":a[0]||(a[0]=u=>f.value.paymentMethod=u),items:[{title:"BN - VENTANILLA",value:7},{title:"BN - PAGALO.PE",value:9}],label:"Pago en",rules:S.value.paymentMethod},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:f.value.paymentSequence,"onUpdate:modelValue":a[1]||(a[1]=u=>f.value.paymentSequence=u),label:"Numero de operacion",type:"number",rules:S.value.paymentSequence},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:f.value.paymentAmount,"onUpdate:modelValue":a[2]||(a[2]=u=>f.value.paymentAmount=u),readonly:"",label:"Monto",type:"number",rules:S.value.paymentAmount},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"6"},{default:e(()=>[l(H,{modelValue:f.value.paymentDate,"onUpdate:modelValue":a[3]||(a[3]=u=>f.value.paymentDate=u),label:"Fecha",type:"date",rules:S.value.paymentDate},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:e(()=>[l(T,{type:"button",variant:"tonal",color:"secondary",onClick:a[4]||(a[4]=u=>p.value=!1)},{default:e(()=>a[15]||(a[15]=[t(" Cancelar ")])),_:1}),l(T,{text:"Inscribirme",color:"primary",type:"submit",variant:"flat",value:"submit",loading:_.value},null,8,["loading"])]),_:1})]),_:1},8,["title"])]}),_:1},512)]),_:1},8,["modelValue"]))}}),$e={key:1},je=K({__name:"CourseView",setup(M){const I=Ce(),L=ke(),A=_e(),p=V(null),_=V([]),S=V(""),f=async()=>{S.value=A.params.id,p.value=await Ie(S.value,2),_.value=await Ae(p.value.id,2),L.setHeading(p.value.name,"Cursos disponibles del modulo")};return ve(()=>{f()}),($,o)=>{const c=se("LnxIcon");return d(),y(Q,null,{default:e(()=>[l(q,{class:""},{default:e(()=>[l(g,{cols:"12",md:"5",lg:"4"},{default:e(()=>[l(U,{elevation:"1"},{default:e(()=>{var i,a;return[l(ee),l(be,{"two-line":""},{default:e(()=>[l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[0]||(o[0]=[t(" Detalles ")])),_:1}),l(C,{"three-line":"",class:"text-subtitle-2"},{default:e(()=>{var m,u,r;return[t(n((m=p.value)==null?void 0:m.coursesCount)+" Cursos , "+n((u=p.value)==null?void 0:u.hoursPractice)+" Hr. Practicas, "+n((r=p.value)==null?void 0:r.hoursTheory)+" Hr. Teoricas ",1)]}),_:1})]),_:1}),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[1]||(o[1]=[t(" Creditos ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var m;return[t(n((m=p.value)==null?void 0:m.credits),1)]}),_:1})]),_:1}),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[2]||(o[2]=[t(" Area(s) ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var m;return[t(n((m=p.value)==null?void 0:m.areas),1)]}),_:1})]),_:1}),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[3]||(o[3]=[t(" Precio de matricula ")])),_:1}),l(C,{class:"text-subtitle-2"},{default:e(()=>{var m;return[t(" S/. "+n((m=p.value)==null?void 0:m.prices),1)]}),_:1})]),_:1})]),_:1}),(i=p.value)!=null&&i.isEnrolled?(d(),y(T,{key:0,variant:"tonal",block:"",color:"success"},{prepend:e(()=>[l(c,{iconName:"verify"})]),default:e(()=>[o[4]||(o[4]=t(" Matriculado "))]),_:1})):E("",!0),((a=p.value)==null?void 0:a.isEnrolled)==!1?(d(),y(O,{key:1},{default:e(()=>{var m;return[((m=p.value)==null?void 0:m.prices)!==null?(d(),y(T,{key:0,block:"",class:"mt-2"},{default:e(()=>[o[5]||(o[5]=t(" Matricular ")),l(Me,{module:p.value,onSuccess:f},null,8,["module"])]),_:1})):(d(),y(z,{key:1,variant:"tonal",color:"error"},{default:e(()=>o[6]||(o[6]=[t(" No se puede matricular, no hay precios establecidos. ")])),_:1}))]}),_:1})):E("",!0)]}),_:1})]),_:1}),l(g,{cols:"12",md:"7",lg:"8"},{default:e(()=>[l(q,null,{default:e(()=>[(d(!0),R(j,null,G(_.value,(i,a)=>(d(),y(g,{cols:"12",key:a},{default:e(()=>[l(U,{elevation:"1",subtitle:i==null?void 0:i.area},{default:e(()=>{var m,u,r;return[l(ee,{class:"pt-0"},{default:e(()=>[b("small",null,[b("strong",null,n(i.code)+" - ",1),t(" "+n(i.name),1)])]),_:2},1024),i.description?(d(),y(P,{key:0,class:"text-caption"},{default:e(()=>[t(n(i.description),1)]),_:2},1024)):E("",!0),l(P,null,{default:e(()=>[b("small",null,n(i.credits.toFixed(2))+" Creditos | "+n(i.hoursPractice)+" Hr. Practicas | "+n(i.hoursTheory)+" Hr. Teoricas ",1)]),_:2},1024),i.hasEnrollment?(d(!0),R(j,{key:1},G(i.enrollment,(v,w)=>(d(),y(P,{class:"border-t",key:w},{default:e(()=>[l(q,null,{default:e(()=>[l(g,{cols:"12",md:"6"},{default:e(()=>[l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[7]||(o[7]=[t("Periodo")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>{var s,D;return[v.periodId==((D=(s=Z(I))==null?void 0:s.enrolled)==null?void 0:D.periodId)?(d(),y(N,{key:0,class:"text-caption",density:"compact",color:"blue"},{default:e(()=>[t(n(v.period),1)]),_:2},1024)):(d(),R("span",$e,n(v.period),1))]}),_:2},1024)]),_:2},1024),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[8]||(o[8]=[t("Gupo")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(n(v.group),1)]),_:2},1024)]),_:2},1024),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[9]||(o[9]=[t("Docente")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(n(v.teacher||"-"),1)]),_:2},1024)]),_:2},1024),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[10]||(o[10]=[t("Nota")])),_:1}),l(C,{class:ge(["text-caption",v.grade>=10?"text-success":"text-error"])},{default:e(()=>[t(n(v.grade||"-"),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),l(g,{cols:"12",md:"6"},{default:e(()=>[l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[11]||(o[11]=[t("Modalidad")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(n(v.modality),1)]),_:2},1024)]),_:2},1024),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[12]||(o[12]=[t("Laboratorio")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(n(v.laboratory),1)]),_:2},1024)]),_:2},1024),l(x,null,{default:e(()=>[l(k,null,{default:e(()=>o[13]||(o[13]=[t("Horario")])),_:1}),l(C,{class:"text-caption"},{default:e(()=>[t(n(v.schedule),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):E("",!0),!i.isApproved&&((m=Z(I))!=null&&m.enrolled)&&i.lastEnrollment!=((r=(u=Z(I))==null?void 0:u.enrolled)==null?void 0:r.periodId)?(d(),y(O,{key:2,class:"bg-grey-lighten-4"},{default:e(()=>{var v;return[l(Ve),(v=p.value)!=null&&v.isEnrolled?(d(),y(T,{key:0,variant:"outlined"},{default:e(()=>[l(Le,{course:i,onSuccess:f},null,8,["course"]),o[14]||(o[14]=t(" Inscríbete "))]),_:2},1024)):E("",!0)]}),_:2},1024)):E("",!0)]}),_:2},1032,["subtitle"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}});export{je as default};
