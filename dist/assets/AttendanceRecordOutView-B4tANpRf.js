import{u as D,b as O,c as A}from"./index-DT43BGsp.js";import{d as P,l as i,aa as R,be as S,aM as q,a as t,w as a,g as V,h as c,r as g,V as d,b as m,e as k,aO as F,f as L,F as U,o as z}from"./index-CMWRQILe.js";import{a as E,V as f}from"./VRow-DB3tsM5B.js";import{V as M}from"./VContainer-DpzZP2Dk.js";import"./index-CklmRQ5G.js";import"./index-BoZKkaqZ.js";const Q={class:"text-h3 text-center text-blue"},W=P({__name:"AttendanceRecordOutView",setup($){const v=D(),y=i(null),l=i(!1),p=i(""),n=i({documentNumber:"",token:"",periodId:null}),_=()=>{const o=new Date;p.value=o.toLocaleTimeString()},N=(o,e)=>{for(const r of o){const[s,...u]=r.cornerPoints;e.strokeStyle="red",e.beginPath(),e.moveTo(s.x,s.y);for(const{x:B,y:T}of u)e.lineTo(B,T);e.lineTo(s.x,s.y),e.closePath(),e.stroke()}},w=async()=>{var o;n.value.periodId=(o=v.current)==null?void 0:o.id,await A(n.value)},C=async()=>{var e;n.value.periodId=(e=v.current)==null?void 0:e.id,await O(n.value)&&(n.value.documentNumber="")},I=async([o])=>{y.value=o;const e=o.rawValue;n.value.token=e,n.value.documentNumber="",l.value=!0,await w(),l.value=!1},x=async()=>{};let b;return R(()=>{_(),b=setInterval(_,1e3),x()}),S(()=>{clearInterval(b)}),(o,e)=>{const r=g("LnxIcon"),s=g("qrcode-stream");return z(),q(U,null,[t(d,{title:"Salida",subtitle:"Registra la salida de los estudiantes",class:"rounded-0"},{append:a(()=>[t(V,{variant:"text",onClick:e[0]||(e[0]=u=>o.$router.go(-1))},{prepend:a(()=>[t(r,{iconName:"arrow-left-3",size:"large"})]),default:a(()=>[e[2]||(e[2]=c(" Atrás "))]),_:1})]),_:1}),t(M,null,{default:a(()=>[t(E,{justify:"center"},{default:a(()=>[t(f,{cols:"12"},{default:a(()=>[t(d,{elevation:"0",variant:"tonal"},{default:a(()=>[t(m,null,{default:a(()=>[k("div",Q,[k("strong",null,[t(r,{iconName:"clock-1",size:"x-large"}),c(" "+F(p.value),1)])])]),_:1})]),_:1})]),_:1}),t(f,{cols:"12",md:"8"},{default:a(()=>[t(d,{loading:l.value,elevation:"0",title:"Escanea el código QR",subtitle:"Use la cámara de su dispositivo para escanear el código QR"},{default:a(()=>[t(s,{onDetect:I,track:N})]),_:1},8,["loading"])]),_:1}),t(f,{cols:"12",md:"4"},{default:a(()=>[t(d,{elevation:"0",title:"Documento",subtitle:"Ingrese el número de documento"},{default:a(()=>[t(m,null,{default:a(()=>[t(L,{modelValue:n.value.documentNumber,"onUpdate:modelValue":e[1]||(e[1]=u=>n.value.documentNumber=u),label:"Número de documento",class:"me-2",density:"comfortable",type:"text"},null,8,["modelValue"])]),_:1}),t(m,null,{default:a(()=>[t(V,{onClick:C,disabled:l.value,variant:"flat",block:""},{default:a(()=>e[3]||(e[3]=[c(" Registrar ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{W as default};
