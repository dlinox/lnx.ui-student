import{V as E,_ as H,c as j,d as z,e as q,f as P}from"./VAlert-CWdeLtXC.js";import{u as W}from"./period.stores-S6Obukk0.js";import{d as T,b as y,A as Y,c as i,bh as Z,w as e,a,j as J,V as R,R as S,i as r,bf as K,bg as Q,bi as X,f as G,e as u,U as N,bj as I,t as n,F as ee,Z as ae,h as k,o as d,b8 as U,r as w,u as V,S as C,b4 as M,b5 as D,b3 as le,b0 as te,G as oe,g as re,ap as ne}from"./index-BCiygQBv.js";import{V as se}from"./VForm-BR8Hmo_o.js";import{V as ue,a as de}from"./VItem-CG-UGpSY.js";import{V as $}from"./VContainer-BGw3r08E.js";import{V as B,a as A}from"./VRow-BY8_SUxz.js";import{u as ie}from"./heading.store-DQe6cmSj.js";const ce=()=>[{title:"Opciones",value:"actions",fixed:!0,width:"70px",align:"center"},{title:"Modulo",value:"module"},{title:"Curso",value:"course",minWidth:"280px"},{title:"Grupo",value:"group",minWidth:"250px"},{title:"Docente",value:"teacher"},{title:"Estado",value:"enrollmentStatus"}],pe={class:"d-flex justify-end"},me=T({__name:"ChangeEnrollmentGroup",props:{group:{}},emits:["success"],setup(L,{emit:b}){const x=b,s=L,_=y(null),p=y({groupId:null}),m=y(!1),t=y(!1),c=y([]),f=async()=>{p.value.groupId&&(t.value=!0,await j({groupId:p.value.groupId,id:s.group.id}),x("success"),m.value=!1,t.value=!1)},g=async()=>{p.value={groupId:null},c.value=await H({groupId:s.group.groupId})};return Y(()=>m.value,v=>{v&&g()}),(v,l)=>(d(),i(Z,{"max-width":"600",modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=o=>m.value=o),activator:"parent"},{default:e(()=>[a(se,{ref_key:"formRef",ref:_,onSubmit:J(f,["prevent"])},{default:e(()=>[a(R,{title:"Cambiar grupo",subtitle:"Selecciona un grupo"},{default:e(()=>[a(ue,{mandatory:"",class:"border-t"},{default:e(()=>[a($,{style:{height:"auto","max-height":"280px","overflow-y":"auto"}},{default:e(()=>[c.value.length===0?(d(),i(E,{key:0,type:"warning",variant:"outlined"},{default:e(()=>l[2]||(l[2]=[r(" No otros grupos habilitados para este curso. ")])),_:1})):S("",!0),a(B,{dense:""},{default:e(()=>[(d(!0),K(ee,null,Q(c.value,(o,F)=>(d(),i(A,{key:F,cols:"12"},{default:e(()=>[a(de,null,{default:e(({isSelected:O,toggle:h})=>[a(R,{color:O?"primary":"",variant:O?"tonal":"plain",onClick:ve=>{h&&h(),p.value.groupId=o.id},class:"border"},{default:e(()=>[a(X,null,{default:e(()=>[a(G,null,{default:e(()=>[u("div",pe,[N((d(),i(I,{class:"rounded-0",variant:"flat",color:o.enrolledStudents/o.minStudents*100>=100?"green-accent-3":o.enrolledStudents/o.minStudents*100>=80?"amber-lighten-2":"red-accent-3"},{default:e(()=>[r(n(`${o.enrolledStudents} / ${o.minStudents}`),1)]),_:2},1032,["color"])),[[U,"Estudiantes inscritos / Mínimo de estudiantes","top"]])]),r(" "+n(o.group)+" - ",1),u("strong",null," S/. "+n(o.price),1),l[7]||(l[7]=u("br",null,null,-1)),a(I,{class:"rounded-0",density:"compact",color:"info",rounded:"sm"},{default:e(()=>[r(n(o.modality),1)]),_:2},1024),l[8]||(l[8]=u("br",null,null,-1)),u("small",null,[l[3]||(l[3]=r(" Docente: ")),u("strong",null,n(o.teacher),1)]),l[9]||(l[9]=u("br",null,null,-1)),u("small",null,[l[4]||(l[4]=r(" Laboratorio: ")),u("strong",null,n(o.laboratory),1)]),l[10]||(l[10]=u("br",null,null,-1)),u("small",null,[l[6]||(l[6]=r(" Horarios: ")),o.schedules?(d(),i(I,{key:0,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>[r(n(o.schedules.days)+" "+n(o.schedules.startHour)+" - "+n(o.schedules.endHour),1)]),_:2},1024)):(d(),i(I,{key:1,rounded:"sm",class:"rounded-0 me-1",density:"compact",color:"primary"},{default:e(()=>l[5]||(l[5]=[r(" No hay horarios ")])),_:1}))])]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","variant","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(ae,null,{default:e(()=>[a(k,{type:"button",variant:"tonal",color:"secondary",onClick:l[0]||(l[0]=o=>m.value=!1)},{default:e(()=>l[11]||(l[11]=[r(" Cancelar ")])),_:1}),a(k,{text:"Cambiar grupo",color:"primary",type:"submit",variant:"flat",value:"submit",loading:t.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1},8,["modelValue"]))}}),fe={class:"text-primary font-weight-bold"},ge=T({__name:"DataTable",setup(L){const b=W();return(x,s)=>{const _=w("LnxIcon"),p=w("LnxDialogConfirm"),m=w("LnxDataTable");return d(),i(R,null,{default:e(()=>[a(m,{headers:V(ce)(),loadDataTable:V(z)},{header:e(({request:t,initDataTable:c,loadingTable:f,debouncedReload:g,reLoadDataTable:v})=>[a(G,{class:"border-t border-b"},{default:e(()=>[a(B,{class:"d-flex justify-space-between align-center"},{default:e(()=>[a(A,{cols:"12",md:"4"},{default:e(()=>[a(re,{modelValue:t.search,"onUpdate:modelValue":l=>t.search=l,label:"Buscar",clearable:"",onInput:g,"onClick:clear":v},null,8,["modelValue","onUpdate:modelValue","onInput","onClick:clear"])]),_:2},1024),a(A,{cols:"12",md:"4",class:"text-end"},{default:e(()=>[N((d(),i(k,{icon:"",variant:"tonal",density:"comfortable",onClick:c,loading:f},{default:e(()=>[a(_,{iconName:"refresh"})]),_:2},1032,["onClick","loading"])),[[U,"Recargar registros"]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"item.actions":e(({item:t,loadDataTable:c})=>{var f,g;return[t.period==((g=(f=V(b))==null?void 0:f.enrolled)==null?void 0:g.period)&&(t.enrollmentStatus=="MATRICULADO"||t.enrollmentStatus=="RESERVADO")?(d(),i(le,{key:0,density:"compact"},{activator:e(({props:v})=>[a(k,oe({icon:"",color:"primary"},v,{density:"compact",variant:"tonal"}),{default:e(()=>[a(_,{iconName:"setting-5"})]),_:2},1040)]),default:e(()=>[a(te,{density:"compact"},{default:e(()=>[t.enrollmentStatus=="MATRICULADO"?(d(),i(C,{key:0,value:"changeGroup"},{default:e(()=>[a(me,{onSuccess:c,group:t},null,8,["onSuccess","group"]),s[0]||(s[0]=r(" Cambiar grupo "))]),_:2},1024)):S("",!0),t.enrollmentStatus=="MATRICULADO"?(d(),i(C,{key:1,value:"reserver"},{default:e(()=>[a(p,{title:"Reservar matrícula",message:"¿Estás seguro de que deseas reservar la matrícula? Esta acción es irreversible y no podrás deshacerla.",onOnConfirm:()=>{V(q)({id:t.id}),c()}},{default:e(()=>[a(E,null,{default:e(()=>s[1]||(s[1]=[u("small",null," Si decide reservar la matrícula, el pago no podrá ser utilizado para otro curso, grupo o módulo. La reserva asegura su cupo, pero el monto abonado quedará exclusivamente asociado a esa matrícula. ",-1)])),_:1})]),_:2},1032,["onOnConfirm"]),s[2]||(s[2]=r(" Reservar "))]),_:2},1024)):S("",!0),t.enrollmentStatus=="MATRICULADO"||t.enrollmentStatus=="RESERVADO"?(d(),i(C,{key:2,value:"cancel"},{default:e(()=>[a(p,{title:"Cancelar matrícula",message:"¿Estás seguro de que deseas cancelar la matrícula? Esta acción es irreversible y podría afectar el uso de tu pago.",onOnConfirm:()=>{V(P)({id:t.id}),c()}},{default:e(()=>[a(E,null,{default:e(()=>s[3]||(s[3]=[u("small",null," Si cancela su matrícula, podrá aplicar el pago realizado a la inscripción de otro curso o módulo dentro de la plataforma. ",-1)])),_:1})]),_:2},1032,["onOnConfirm"]),s[4]||(s[4]=r(" Cancelar matrícula "))]),_:2},1024)):S("",!0)]),_:2},1024)]),_:2},1024)):S("",!0)]}),"item.course":e(({item:t})=>[a(C,null,{default:e(()=>[a(M,{class:"text-subtitle-2 font-weight-bold"},{default:e(()=>[r(n(t.course),1)]),_:2},1024),a(D,null,{default:e(()=>[r(n(t.area),1)]),_:2},1024)]),_:2},1024)]),"item.group":e(({item:t})=>[a(C,null,{default:e(()=>[a(M,{class:"text-subtitle-2"},{default:e(()=>[r(n(t.period)+" - ",1),u("span",fe,n(t.group),1)]),_:2},1024),a(D,null,{default:e(()=>[r(n(t.laboratory),1)]),_:2},1024),a(D,null,{default:e(()=>[r(n(t.modality),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["headers","loadDataTable"])]),_:1})}}}),ke=T({__name:"EnrollmentView",setup(L){const b=ie(),x=async()=>{b.setHeading("Mis matriculas","Lista de matriculas realizadas")};return ne(()=>{x()}),(s,_)=>(d(),i($,null,{default:e(()=>[a(ge)]),_:1}))}});export{ke as default};
